

Купил давно принтер MakerPi P3 Pro IDEX, он в принципе хороший, в части механики, но вот прошивка от китайцев доставляла проблем. Если просто печатать одним соплом еще ничего, но как только ставишь печать 2 экструдерами, принтер начинает работать как ему хочется, а не как надо.

После его разборки удалось выяснить что там стоит сьемная плата с микроконтроллером GD32F450iih6

Мне удалось к нему подключиться через SWD StLink v.2 считать и забекапить прошивку на всякий пожарный.

Было желание прошить туда что нибудь, но первая попытка не удалась и я это как то заборсил, печатая одним соплом.

И вот недавно мне это снова надоело, да и печать 2 соплами нужна, поэтому были проведены испытания прошивки его клиппером и коннекта с сервером клиппера.

Через энное количество попыток прошивка удалась и даже что то там она печатала в консоли.

Параметры make menuconfig:

MakerPi P3 pro F450 board klipper

Но с сервером плата соединяться не хотела.

Как оказалось для правильного соединения надо поменять местами RX и TX и сервер клиппера сразу все увидел.

Ну а дальше дело техники. Создаем файл принтера в котором указаны все пины микроконтроллера,

и через интерфейс mainsall дергам их по одному.

MakerPi P3 pro F450 board klipper
	

MakerPi P3 pro F450 board klipper
	

и так все пины микропроцессора далее в файле

Конечно к ногам платы которая снята с принтера для удобства я подключил логический анализатор, у меня DSLogic U2Basic переделанный в PRO.

В плате принтера 4 ряда по 15 пинов, в анализаторе как раз 16 каналов.Поэтому 4 раза подключаем эти ряды пинов и повторяем дерганье ног микроконтроллера через klipper.

Определяем что где, дополнительно считываем широкий разьем, потому что туда тоже идут ноги процессора и в результате получаем файл соответствия ног и пинов микроконтроллера GD32F450iih6 в принтере MakerPi P3 Pro.

MakerPi P3 pro F450 board klipper

Добил схему принтера с распиновкой на большой плате

Makerpi P3 Pro Full Schematics with custom UART mod tmc2209 klipper

Доработка заключается в следующем:

На каждый драйвер кроме Z2 идет линия CS. Она приходит на ногу UART но на драйвере не запаяна перемычка для ее использования. Соответственно запаиваем перемычку на каждом драйвере - средний контакт перемычки на контакт идущий на ногу UART.

Кроме этого для работы UART необходимо подтянуть ногу UART к плюсу.
Так как она уже подтянута к минусу резистором 10к, а vio = 5v, припаиваем к ногам vio и UART резистор 5к чтобы получить правильный высокий уровень 3.3в. Хотя большинство ног толерантно к 5в, лучше если везде будет одинаково.(PA4 идущая на драйвер не толерантна к 5в)



3D Today Техничка MakerPi P3 pro F450 board klipper
MakerPi P3 pro F450 board klipper
estratos
01.12.2025
440
4
Техничка
6

Купил давно принтер MakerPi P3 Pro IDEX, он в принципе хороший, в части механики, но вот прошивка от китайцев доставляла проблем. Если просто печатать одним соплом еще ничего, но как только ставишь печать 2 экструдерами, принтер начинает работать как ему хочется, а не как надо.

После его разборки удалось выяснить что там стоит сьемная плата с микроконтроллером GD32F450iih6

Мне удалось к нему подключиться через SWD StLink v.2 считать и забекапить прошивку на всякий пожарный.

Было желание прошить туда что нибудь, но первая попытка не удалась и я это как то заборсил, печатая одним соплом.

И вот недавно мне это снова надоело, да и печать 2 соплами нужна, поэтому были проведены испытания прошивки его клиппером и коннекта с сервером клиппера.

Через энное количество попыток прошивка удалась и даже что то там она печатала в консоли.

Параметры make menuconfig:

MakerPi P3 pro F450 board klipper

Но с сервером плата соединяться не хотела.

Как оказалось для правильного соединения надо поменять местами RX и TX и сервер клиппера сразу все увидел.

Ну а дальше дело техники. Создаем файл принтера в котором указаны все пины микроконтроллера,

и через интерфейс mainsall дергам их по одному.

MakerPi P3 pro F450 board klipper
	

MakerPi P3 pro F450 board klipper
	

и так все пины микропроцессора далее в файле

Конечно к ногам платы которая снята с принтера для удобства я подключил логический анализатор, у меня DSLogic U2Basic переделанный в PRO.

В плате принтера 4 ряда по 15 пинов, в анализаторе как раз 16 каналов.Поэтому 4 раза подключаем эти ряды пинов и повторяем дерганье ног микроконтроллера через klipper.

Определяем что где, дополнительно считываем широкий разьем, потому что туда тоже идут ноги процессора и в результате получаем файл соответствия ног и пинов микроконтроллера GD32F450iih6 в принтере MakerPi P3 Pro.

40 пиновый разьем подключения LCD трогать не стал.

MakerPi P3 pro F450 board klipper

Следующий этап - установка платы в принтер, дерганье ног микроконтроллером уже в принтере

и написание нормального конфига принтера MakerPi P3 Pro для klipper.

Klipper
MakerPi P3 Pro
gd32f450
flash
6
Еще больше интересных статей
Как я создал себе проблемы с 3D принтером Bambulab p1s
Jeyson
27.11.2025
6217
28
30
Здравствуйте, уважаемые читатели!

Решил поделиться своими приключениями. Возможно кому-то...
Читать дальше
Сушилка для PPS или умная печка для сушки филамента
Mihail Vladimirovich
18.11.2025
1257
4
15
Всем салют!

В прошлом году по стечению обстоятельств обзавелся большим принтером с...
Читать дальше
GCODE: Основы
xedos
25.04.2016
430343
67
226
Добрый день Уважаемые читатели!

GCODE: Плюшки от ПавлушкиПосле написания предыдущей...
Читать дальше
4 комментария
Отслеживать новые
estratos 01 дек 2025
1

Разобрался и с разьемом LCD. Оказывается у меня завалялся переходник со шлейфа на 40Pin.

Пробежался так же анализатором и получил еще пинов для управления чем то дополнительным, так как клиппер не поддерживает экраны 8080 один из которых стоит на этом принтере.
Ответить
estratos сегодня, 02:52
0

Добил схему принтера с распиновкой на большой плате

Makerpi P3 Pro Full Schematics with custom UART mod tmc2209 klipper

Ответить
estratos сегодня, 03:31
0

Доработка заключается в следующем:

На каждый драйвер кроме Z2 идет линия CS. Она приходит на ногу UART но на драйвере не запаяна перемычка для ее использования. Соответственно запаиваем перемычку на каждом драйвере - средний контакт перемычки на контакт идущий на ногу UART.

Кроме этого для работы UART необходимо подтянуть ногу UART к плюсу.
Так как она уже подтянута к минусу резистором 10к, а vio = 5v, припаиваем к ногам vio и UART резистор 5к чтобы получить правильный высокий уровень 3.3в. Хотя большинство ног толерантно к 5в, лучше если везде будет одинаково.(PA4 идущая на драйвер не толерантна к 5в)

По неизвестной причине E1 UART работает только если отпаять резистор 10k замыкающий UART на землю.

Так как на Z2 стоит отдельно драйвер на плате выхода кабеля на вторую головку, я попытался там тоже сделать драйвер с UART но это привело к сгоранию драйвера, видимо какие то ноги использованы для других целей. Поэтому или не пытайтесь делать UART mod для Z2 драйвера или выносите его на отдельную плату, как я и сделал установив туда запасной драйвер TMC2208 который тоже работает через UART.
Для этого просто взял следующую ногу на разьеме откуда идет кабель Z2 - CK - PC12 и протянул от нее кабель до платы с драйвером через резистор 4.7к на ногу UART.
Там выполнена та же самая доработка, резистор 5к между vio и UART пином.
Плюс из колодки для старого драйвера взял питание для двигателя - VM, драйвера VIO и минус GND.

printer.cfg MakerPi P3 Pro Klipper
